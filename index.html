<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Números perfectos en C#</title>
<style>
  :root{
    --bg:#0b0f19; --text:#e5e7eb; --muted:#9ca3af; --card:#0f172a;
    --accent:#22c55e; --accent-2:#22d3ee; --accent-3:#a78bfa;
    --border:#1f2937; --code-bg:#0a0f1f; --code-text:#e5e7eb; --code-line:#0f1a34;
    --shadow:0 10px 24px rgba(0,0,0,.28);
    --glass:rgba(255,255,255,.06);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial;background:var(--bg);color:var(--text);line-height:1.6}

  /* NAVBAR adornada */
  .topbar{
    position:sticky;top:0;z-index:60;
    background:linear-gradient(135deg,rgba(34,197,94,.25),rgba(34,211,238,.25),rgba(167,139,250,.25));
    backdrop-filter: blur(8px);
    border-bottom:1px solid rgba(255,255,255,.08);
  }
  .topbar .inner{
    max-width:1200px;margin:0 auto;padding:.7rem 1rem;
    display:flex;align-items:center;gap:1rem;
  }
  .brand{
    display:flex;align-items:center;gap:.6rem;font-weight:800;letter-spacing:.2px;
  }
  .logo{
    width:28px;height:28px;border-radius:8px;
    background: conic-gradient(from 200deg at 50% 50%, var(--accent), var(--accent-2), var(--accent-3), var(--accent));
    box-shadow:0 6px 18px rgba(0,0,0,.35);
  }
  .nav{
    display:flex;gap:.6rem;margin-left:1rem;
  }
  .nav a{
    text-decoration:none;color:var(--text);opacity:.85;font-weight:600;
    padding:.35rem .6rem;border-radius:.6rem;border:1px solid transparent;
  }
  .nav a:hover{opacity:1;border-color:rgba(255,255,255,.12);background:rgba(255,255,255,.03)}
  .spacer{flex:1}
  .search{
    display:flex;align-items:center;gap:.4rem;background:var(--glass);border:1px solid rgba(255,255,255,.08);
    padding:.35rem .6rem;border-radius:.7rem;
  }
  .search input{
    background:transparent;border:0;outline:0;color:var(--text);width:160px;
  }
  .btn{
    appearance:none;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);color:var(--text);
    padding:.45rem .7rem;border-radius:.6rem;font-weight:600;cursor:pointer;
    box-shadow:0 4px 12px rgba(0,0,0,.15)
  }
  .btn:hover{background:rgba(255,255,255,.1)}
  .btn:active{transform:translateY(1px)}

  /* LAYOUT */
  .wrap{max-width:1200px;margin:1.2rem auto;padding:0 1rem;display:grid;gap:1rem}
  @media(min-width:960px){ .row1{display:grid;grid-template-columns:1fr 1fr;gap:1rem} }
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:1rem 1.2rem;box-shadow:var(--shadow)}
  h1{margin:.2rem 0 1rem;font-size:2rem}
  h2{margin:.2rem 0 .8rem;font-size:1.25rem}
  .muted{color:var(--muted)}
  .tag{display:inline-block;background:rgba(34,197,94,.15);color:#bbf7d0;padding:.2rem .5rem;border-radius:8px;font-size:.85rem;font-weight:700}

  /* PANEL ALTURAS */
  .pane{max-height:70vh; overflow:auto}
  .steps-pane{position:sticky; top:1rem}

  /* CODE TOOLBAR */
  .code-toolbar{
    display:flex;align-items:center;gap:.5rem;margin-bottom:.6rem;
  }
  .lang-badge{
    font-weight:800;font-size:.8rem;letter-spacing:.4px;
    background:linear-gradient(90deg,var(--accent),var(--accent-2));
    color:#052318; padding:.25rem .5rem;border-radius:.5rem;
  }
  .toolbar-spacer{flex:1}
  .seg{display:flex;border:1px solid rgba(255,255,255,.12);border-radius:.6rem;overflow:hidden}
  .seg button{
    border:0;background:transparent;color:var(--text);padding:.35rem .6rem;cursor:pointer
  }
  .seg button:hover{background:rgba(255,255,255,.08)}
  .seg button + button{border-left:1px solid rgba(255,255,255,.12)}

  /* CÓDIGO INTERACTIVO */
  .code-wrap{position:relative}
  .copy{position:absolute;right:.6rem;top:.6rem;font-size:.85rem;background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,.12);border-radius:8px;padding:.3rem .55rem;cursor:pointer}
  .copy:hover{color:var(--text);background:rgba(255,255,255,.05)}
  pre.code{
    margin:0;overflow:auto;background:var(--code-bg);color:var(--code-text);
    border-radius:10px;padding:1rem;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size: var(--code-size, .95rem);
    counter-reset:line; line-height:1.55; border:1px solid rgba(255,255,255,.08);
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
  }
  .line{
    display:block;padding:.05rem .5rem;border-left:4px solid transparent;
    background:linear-gradient(90deg,transparent,transparent 70%,rgba(255,255,255,.02) 100%);
    transition:background .18s ease,border-color .18s ease, box-shadow .18s ease;
    cursor:text;
  }
  .line:nth-child(odd){ background:linear-gradient(90deg,rgba(255,255,255,.015),transparent 60%) } /* sutil cebra */
  .line:hover{ background:linear-gradient(90deg, rgba(167,139,250,.12), transparent 80%) }
  .line::before{
    counter-increment:line; content:counter(line);
    display:inline-block;width:2rem;opacity:.38;user-select:none;margin-right:.5rem
  }
  .line.active{
    background:linear-gradient(90deg, rgba(34,211,238,.18), transparent 70%);
    border-left-color:var(--accent-2);
    box-shadow: inset 0 0 0 9999px rgba(255,255,255,.02), 0 0 0 1px rgba(34,211,238,.25);
  }

  /* STEPS */
  .steps{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:.6rem}
  .step{
    background:rgba(255,255,255,.04);
    border:1px solid rgba(255,255,255,.12);
    padding:.7rem .8rem;border-radius:12px;cursor:pointer
  }
  .step:hover{border-color:rgba(34,211,238,.5)}
  .step[aria-pressed="true"]{border-color:var(--accent-2); box-shadow:0 0 0 2px rgba(34,211,238,.25) inset}
  .step .badge{display:inline-flex;align-items:center;justify-content:center;width:24px;height:24px;border-radius:50%;background:var(--accent-2);color:#06252a;font-weight:800;margin-right:.5rem}
  .note{font-size:.9rem;color:var(--muted)}

  /* SANDBOX */
  .sandbox-grid{display:grid;gap:.8rem}
  .sandbox-grid label{font-weight:600}
  .sandbox-grid input,.sandbox-grid textarea{
    width:100%;padding:.6rem .7rem;border:1px solid rgba(255,255,255,.12);border-radius:10px;background:#0b1224;color:#e5e7eb;
  }
  .terminal{
    font-family:ui-monospace, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New";
    background:#0a0f1f;color:#e5e7eb;border-radius:10px;padding:1rem;min-height:140px;white-space:pre-wrap;
    border:1px solid rgba(255,255,255,.08)
  }
  .runbar{display:flex;gap:.6rem;align-items:center;flex-wrap:wrap}
</style>
</head>
<body>
  <!-- NAV -->
  <header class="topbar">
    <div class="inner">
      <div class="brand">
        <span>Numeros Perfectos • Explicado</span>
      </div>
      <div class="spacer"></div>
      <button class="btn" id="themeBtn" title="Claro/Oscuro">Tema</button>
    </div>
  </header>

  <main class="wrap">
    <!-- Título -->
    <section class="card">
      <h1>Números perfectos en C# <span class="tag">Código + Explicación en paralelo</span></h1>
      <p class="muted">El programa lee el número introducido por el usuario en un total de <strong>5 intentos</strong> el número introducido ha de ser en un rango de <em>(1 a 1000)</em> el programa se encarga de decidir si el numero es <em>perfecto</em> si la suma de los divisores del número introducido es igual al número introducido y <em>no perfecto</em> en caso de que no se cumpla la condición</p>
    </section>

    <!-- Fila 1: Código | Explicación -->
    <div class="row1">
      <section class="card pane">
        <h2 style="display:flex;align-items:center;gap:.6rem">Código
          <span class="lang-badge">C#</span>
          <span class="toolbar-spacer"></span>
        </h2>

        <!-- Herramientas de código -->
        <div class="code-toolbar" role="toolbar" aria-label="herramientas código">
          <div class="seg" aria-label="tamaño de fuente">
            <button id="codeSm">A−</button>
            <button id="codeMd">A</button>
            <button id="codeLg">A+</button>
          </div>
          <div class="seg" aria-label="ajustes">
            <button id="wrapToggle">Wrap</button>
          </div>
          <span class="toolbar-spacer"></span>
          <button class="btn copy" data-copy="#example">Copiar</button>
        </div>

        <div class="code-wrap">
          <pre id="example" class="code">
<span class="line">int N = 5, i = 0, n = 0, d = 0, suma = 0, limite = 0;</span>
<span class="line">try</span>
<span class="line">{</span>
<span class="line">    for (i = 1; i &lt;= N; i = i + 1)</span>
<span class="line">    {</span>
<span class="line">        Console.Write("Número (1 - 1000): ");</span>
<span class="line">        n = int.Parse(Console.ReadLine());</span>
<span class="line"></span>
<span class="line">        if (n &lt; 1 || n &gt; 1000)</span>
<span class="line">        {</span>
<span class="line">            Console.WriteLine("Fuera de rango.");</span>
<span class="line">        }</span>
<span class="line">        else</span>
<span class="line">        {</span>
<span class="line">            suma = 0;</span>
<span class="line">            limite = n / 2;</span>
<span class="line">            for (d = 1; d &lt;= limite; d = d + 1)</span>
<span class="line">            {</span>
<span class="line">                if (n % d == 0) suma = suma + d;</span>
<span class="line">            }</span>
<span class="line"></span>
<span class="line">            if (suma == n) Console.WriteLine($"{n} Perfecto");</span>
<span class="line">            else Console.WriteLine($"{n} No perfecto");</span>
<span class="line">        }</span>
<span class="line">    }</span>
<span class="line">}</span>
<span class="line">catch</span>
<span class="line">{</span>
<span class="line">    Console.WriteLine("Entrada inválida");</span>
<span class="line">}</span>
<span class="line">finally</span>
<span class="line">{</span>
<span class="line">    Console.WriteLine("Pulsa una tecla para salir...");</span>
<span class="line">    Console.ReadKey();</span>
<span class="line">}</span>
          </pre>
        </div>
      </section>

      <aside class="card pane steps-pane">
        <h2>Explicación paso a paso</h2>
        <ul class="steps" data-for="#example">
          <li class="step" data-lines="1" aria-pressed="false"><span class="badge">1</span><strong>Variables</strong> <div><small>Se declaran como número entero {N, i, n, d, suma, limite}.</small></div></li>
          <li class="step" data-lines="2-3,24-30,31-35" aria-pressed="false"><span class="badge">2</span><strong>try/catch/finally</strong> <div><small>Se utiliza try/catch/finally para detectar y evitar errores en el proceso de ejecución.</small></div></li>
          <li class="step" data-lines="4-5,23" aria-pressed="false"><span class="badge">3</span><strong>Primer bucle</strong> <div><small>Cada entrada del usuario suma por 1 el valor de i permitiendo al programa llevar la cuenta de los intentos</small></div></li>
          <li class="step" data-lines="6-7" aria-pressed="false"><span class="badge">4</span><strong>Escritura y lectura</strong> <div><small>El programa instruye al usuario como ha de ser usado mediante el <code>Console.WriteLine("Número (1 - 1000);")</code> y posteriormente permite al usuario utilizar el programa leyendo el número introducido por el usuario con <code>n = int.Parse(Console.ReadLine());</code>.</small></div></li>
          <li class="step" data-lines="9-12" aria-pressed="false"><span class="badge">5</span><strong>Comprobación de rango</strong> <div><small>El programa comprueba si el número introducido por el usuario es válido o no, en caso de serlo ejecuta el programa con el bloque <code>else</code> en caso contrario el procrama muestra por consola que nos encontramos fuera de rango.</small></div></li>
          <li class="step" data-lines="13-16" aria-pressed="false"><span class="badge">6</span><strong>Declaración de <code>límite</code> y del valor de <code>suma</code></strong> <div><small>Se declara <code>suma = 0</code> y<code>limite = n / 2</code> con esto declaramos que el valor de la suma de los dividendos es por el momento 0 para posteriormente modificarlo, por otra parte declaramos que no se puede superar la mitad del valor de <code>n</code></small></div></li>
          <li class="step" data-lines="17-20" aria-pressed="false"><span class="badge">7</span><strong>Divisores</strong> <div><small>En la declaracion del bucle para divisores <code>for (d = 1; d <= limite; d = d + 1)</code> damos la condición en primer lugar de que el primer divisor vale 1 <code>d = 1</code>, posteriormente declaramos que todo se cumpla mientras sea cierto el que el numero del divisor no supere el límite <code>d <= limite</code> por último le decimos al bucle que con cada intento le sume 1 al valor del divisor <code>d = d + 1</code>. A continuación si se cumple la condición de que el módulo de la division de <code>n % d ==0</code> es igual a 0 entonces el valor de suma es igual al valor predefinido de suma más el valor del divisor que cumple con la condicion anteriormente mencionada.</small></div></li>
          <li class="step" data-lines="22-23" aria-pressed="false"><span class="badge">8</span><strong>Resultado</strong> <div><small>Compara <code>suma</code> con <code>n</code> y entonces en caso de cumplirse la igualdad entre <code>suma</code> y <code>n</code> devuelve <em>Perfecto</em> en caso contrario devuelve <em>No perfecto</em>.</small></div></li>
        </ul>
        <p class="note">Haz clic para fijar/desfijar el resaltado. Panel sticky + scroll propio.</p>
      </aside>
    </div>

    <!-- Debajo: Sandbox -->
    <section class="card">
      <h2>Sandbox: ejecuta la lógica aquí</h2>
      <div class="sandbox-grid">
        <label for="N">N (cuántos números leer):</label>
        <input id="N" type="number" min="1" max="20" value="5" />
        <label for="nums">Introduce los N números (1–1000), separados por espacio o salto de línea:</label>
        <textarea id="nums" rows="6">6
28
496
12
7</textarea>
        <div class="runbar">
          <button class="btn" id="runBtn">Ejecutar</button>
          <button class="btn" id="clearBtn">Limpiar salida</button>
        </div>
        <div class="terminal" id="out" aria-live="polite"></div>
        <p class="note">El sandbox replica la lógica del código en JS para poder probarla sin salir de la página.</p>
      </div>
    </section>

    <!-- Notas -->
    <section class="card">
      <h2>Notas</h2>
      <ul>
        <li>Esta página ha sido hecha con ayuda de inteligencia artificial, esta pagina esta inspirada en el estilo que tiene <a href="https://www.w3schools.com/" target="_blank">w3schools</a> no obstante todo el texto escrito y unas modificaciones no han sido realizadas por IA</li>
        <br>
        <li>Este es un pequeño proyecto al que añadire a mi portfolio personal, esta página ha sido hecha con la finalidad de probar mi habilidad creativa y permitirme en un futuro poder reescribirla entera por mi propia cuenta.</li>
      </ul>
    </section>
  </main>

<script>
  // Tema (mantiene estilos)
  document.getElementById('themeBtn').addEventListener('click',()=>document.body.classList.toggle('light'));

  // Copiar código
  document.querySelectorAll('.copy').forEach(btn=>{
    btn.addEventListener('click', async ()=>{
      const el = document.querySelector(btn.getAttribute('data-copy'));
      try{
        await navigator.clipboard.writeText(el.innerText);
        const old = btn.textContent; btn.textContent='¡Copiado!'; setTimeout(()=>btn.textContent=old,1200);
      }catch{ const old = btn.textContent; btn.textContent='Error'; setTimeout(()=>btn.textContent=old,1200); }
    });
  });

  // Toolbar de código: tamaño + wrap
  const code = document.getElementById('example');
  document.getElementById('codeSm').onclick = ()=> code.style.setProperty('--code-size','.85rem');
  document.getElementById('codeMd').onclick = ()=> code.style.setProperty('--code-size','.95rem');
  document.getElementById('codeLg').onclick = ()=> code.style.setProperty('--code-size','1.05rem');
  let wrapped = false;
  document.getElementById('wrapToggle').onclick = ()=>{
    wrapped = !wrapped;
    code.style.whiteSpace = wrapped ? 'pre-wrap' : 'pre';
  };

  // Utilidades
  function parseLines(str){
    return str.split(',').flatMap(p=>{
      if(p.includes('-')){const[a,b]=p.split('-').map(n=>parseInt(n,10));const r=[];for(let i=a;i<=b;i++)r.push(i);return r;}
      const n=parseInt(p,10);return Number.isNaN(n)?[]:[n];
    });
  }
  function clearActive(container){container.querySelectorAll('.line.active').forEach(l=>l.classList.remove('active'));}

  // Fijado/desfijado con click (toggle lock) + hover respetando el lock
  document.querySelectorAll('.steps').forEach(list=>{
    const targetSel = list.getAttribute('data-for') || '#example';
    const codeEl = document.querySelector(targetSel);
    const lines = codeEl ? [...codeEl.querySelectorAll('.line')] : [];

    let locked = false;
    let lockedMap = [];

    const setActive = (map,on)=> map.forEach(n=>{
      const el = lines[n-1]; if(el) el.classList.toggle('active', on);
    });
    const sameMap = (a,b)=> a.length===b.length && a.every((v,i)=>v===b[i]);

    list.querySelectorAll('.step').forEach(step=>{
      const map = parseLines(step.getAttribute('data-lines')||'');
      step.style.userSelect = 'none';
      step.addEventListener('mouseenter', ()=>{ if(!locked) setActive(map,true); });
      step.addEventListener('mouseleave', ()=>{ if(!locked) setActive(map,false); });
      step.addEventListener('click', ()=>{
        if(locked && sameMap(map, lockedMap)){
          // Desbloquear
          locked=false; lockedMap=[]; list.querySelectorAll('.step[aria-pressed="true"]').forEach(s=>s.setAttribute('aria-pressed','false'));
          clearActive(codeEl);
          return;
        }
        // Bloquear nuevo
        locked=true; lockedMap=map.slice();
        list.querySelectorAll('.step[aria-pressed="true"]').forEach(s=>s.setAttribute('aria-pressed','false'));
        step.setAttribute('aria-pressed','true');
        clearActive(codeEl); setActive(map,true);
        const first = lines[map[0]-1]; if(first){ first.scrollIntoView({behavior:'smooth',block:'center'}); }
      });
    });

    // También permitir marcar líneas al hacer click directo en el código (quality-of-life)
    lines.forEach(ln=>{
      ln.addEventListener('click', ()=>{
        ln.classList.toggle('active');
        // si tocamos el código manualmente, se desancla el lock de pasos
        locked=false; lockedMap=[]; list.querySelectorAll('.step[aria-pressed="true"]').forEach(s=>s.setAttribute('aria-pressed','false'));
      });
    });
  });

  // Sandbox JS: emula la lógica C#
  const out = document.getElementById('out');
  function println(s=''){ out.textContent += (out.textContent ? '\n' : '') + s; }

  // Limpiar salida: borra también el botón de "Simular tecla"
  document.getElementById('clearBtn').addEventListener('click',()=>{
    out.textContent='';
    const rk = document.getElementById('readkey-btn');
    if(rk) rk.remove();
  });

  // Ejecutar
  document.getElementById('runBtn').addEventListener('click', ()=>{
    // Reset de salida (pero mantenemos la lógica de crear/mostrar un solo botón)
    out.textContent = '';

    const N = parseInt(document.getElementById('N').value, 10);
    const raw = document.getElementById('nums').value.trim();
    const tokens = raw.split(/\s+/);

    try{
      if(Number.isNaN(N) || N < 1){ throw new Error('N inválido'); }
      if(tokens.length < N){ throw new Error('Faltan números'); }

      let i=0, n=0, d=0, suma=0, limite=0;
      for(i=1; i<=N; i=i+1){
        const t = tokens[i-1];
        n = Number.parseInt(t,10);
        if(Number.isNaN(n)) throw new Error('parse');

        if(n<1 || n>1000){
          println("Fuera de rango.");
        }else{
          suma=0; limite=Math.floor(n/2);
          for(d=1; d<=limite; d=d+1){
            if(n % d===0) suma=suma+d;
          }
          if(suma===n) println(`${n} Perfecto`);
          else println(`${n} No perfecto`);
        }
      }
    }catch(e){
      println("Entrada inválida");
    }finally{
      println("Pulsa una tecla para salir...");

      // Reusar/crear un ÚNICO botón de "Simular tecla"
      let rk = document.getElementById('readkey-btn');
      if(!rk){
        rk = document.createElement('button');
        rk.id = 'readkey-btn';
        rk.textContent = 'Simular tecla';
        rk.className = 'btn';
        rk.style.marginTop = '.6rem';
        rk.addEventListener('click', ()=> rk.remove());
        out.parentElement.appendChild(rk);
      } else {
        // si ya existía (de ejecuciones previas), lo “reseteamos” y lo mostramos
        rk.textContent = 'Simular tecla';
        rk.style.display = 'inline-block';
      }
    }
  });
</script>
</body>
</html>
